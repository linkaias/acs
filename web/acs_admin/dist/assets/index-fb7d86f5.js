import{_ as q,r as u,d as L,a as F,o as I,E as W,b as n,c as z,e as v,f as J,w as a,g as d,t as K,h as e,i as w,F as N,j as $,u as B,k as Q,l as X,m as le}from"./index-07fbba9f.js";import{i as G,b as ne,T as R,d as se}from"./index-008284a0.js";import{V as Z,T as ee}from"./time_utils-1ad82d01.js";import"./request-675639ab.js";const re={class:"card-header"},ie={class:"right_content"},de={class:"chart"},ce={__name:"methodChart",props:{chartName:{type:String,default:"chart"}},setup(S){const p=u(null),Y=S,h=["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS"],f=u(!1),b=u(null),g={tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value"},series:[]},y=ee();let E=L(),P=L();P=P.subtract(15,"minute");const M=u([P.format("YYYY-MM-DD HH:mm:ss"),E.format("YYYY-MM-DD HH:mm:ss")]),t=F({time_dimension:"min",begin_time:M.value[0],end_time:M.value[1],method:""});I(()=>{b.value=G(p.value),h.length>0&&(t.method=h[0]),C()});const D=r=>{t.time_dimension=r,C()},s=r=>{t.method=r,C()},C=async()=>{let r=Z(t.time_dimension,t.begin_time,t.end_time);if(r!==""){W.error(r);return}f.value=!0;let c=await ne(t.time_dimension,t.begin_time,t.end_time,t.method);f.value=!1;let o=c.data,i=t.method;g.xAxis.data=o.x_data,g.series=[{name:i,type:"line",data:o.y_data_all_count,areaStyle:{}}],g&&b.value.setOption(g),b.value.setOption(g)},V=()=>{C()},j=r=>{if(r[0]===""||r[1]===0)return!1;t.begin_time=r[0],t.end_time=r[1],C()};return(r,c)=>{const o=n("el-option"),i=n("el-select"),_=n("el-form-item"),A=n("el-date-picker"),x=n("el-form"),O=n("el-icon"),m=n("el-card"),T=z("loading");return v(),J(m,{class:"box-card",shadow:"never"},{header:a(()=>[d("div",re,[d("span",null,K(Y.chartName),1),d("div",ie,[e(x,{inline:!0},{default:a(()=>[e(_,{label:"Method筛选"},{default:a(()=>[e(i,{filterable:"",modelValue:t.method,"onUpdate:modelValue":c[0]||(c[0]=l=>t.method=l),placeholder:"Method筛选",onChange:s},{default:a(()=>[(v(),w(N,null,$(h,(l,k)=>e(o,{key:k,label:l,value:l},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(_,{label:"时间粒度"},{default:a(()=>[e(i,{modelValue:t.time_dimension,"onUpdate:modelValue":c[1]||(c[1]=l=>t.time_dimension=l),placeholder:"时间粒度",onChange:D},{default:a(()=>[(v(),w(N,null,$(["min","hour","day"],(l,k)=>e(o,{key:k,label:l,value:l},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),e(R)]),_:1}),e(_,{label:"时间范围"},{default:a(()=>[e(A,{modelValue:M.value,"onUpdate:modelValue":c[2]||(c[2]=l=>M.value=l),type:"datetimerange",onChange:j,shortcuts:B(y),"value-format":"YYYY-MM-DD HH:mm","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue","shortcuts"]),e(R)]),_:1})]),_:1}),e(O,{onClick:V,style:{cursor:"pointer"}},{default:a(()=>[e(B(Q))]),_:1})])])]),default:a(()=>[X((v(),w("div",de,[d("div",{ref_key:"ref_chart_container",ref:p,style:{height:"400px"}},null,512)])),[[T,f.value]])]),_:1})}}},_e=q(ce,[["__scopeId","data-v-70edf2ac"]]);const ue={class:"card-header"},me={class:"right_content"},pe={class:"chart"},he={__name:"allMethodChart",props:{chartName:{type:String,default:"chart"},groupList:{type:Array,default:[]}},setup(S){const p=u(null),Y=u(null),h=S,f=u(!1),b=u(null),g=u(null),y={tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value"},series:[]},E={tooltip:{trigger:"item"},legend:{top:"5%",left:"center"},series:[{name:"请求方式调用占比",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},labelLine:{show:!1},data:[]}]},P=ee();let M=L(),t=L();t=t.subtract(15,"minute");const D=u([t.format("YYYY-MM-DD HH:mm:ss"),M.format("YYYY-MM-DD HH:mm:ss")]),s=F({time_dimension:"min",begin_time:D.value[0],end_time:D.value[1]});I(()=>{b.value=G(p.value),g.value=G(Y.value),h.groupList.length>0&&(s.group_id=h.groupList[0].id),V()});const C=o=>{s.time_dimension=o,V()},V=async()=>{let o=Z(s.time_dimension,s.begin_time,s.end_time);if(o!==""){W.error(o);return}f.value=!0;let i=await se(s.time_dimension,s.begin_time,s.end_time);f.value=!1;let _=i.data;const A=[];y.xAxis.data=_.x_data;let x=[],O=[];Object.keys(_.y_data).forEach(m=>{O.push(m),x.push({name:m,type:"line",data:_.y_data[m]});let T=0;_.y_data[m].forEach(l=>{T+=l}),A.push({value:T,name:m})}),y.legend.data=O,y.series=x,b.value.setOption(y),b.value.setOption(y),r(A)},j=()=>{V()},r=o=>{E.series[0].data=o,g.value.setOption(E)},c=o=>{if(o[0]===""||o[1]===0)return!1;s.begin_time=o[0],s.end_time=o[1],V()};return(o,i)=>{const _=n("el-option"),A=n("el-select"),x=n("el-form-item"),O=n("el-date-picker"),m=n("el-form"),T=n("el-icon"),l=n("el-card"),k=n("el-col"),te=n("el-row"),ae=z("loading");return v(),J(l,{class:"box-card",shadow:"never"},{header:a(()=>[d("div",ue,[d("span",null,K(h.chartName),1),d("div",me,[e(m,{inline:!0},{default:a(()=>[e(x,{label:"时间粒度"},{default:a(()=>[e(A,{modelValue:s.time_dimension,"onUpdate:modelValue":i[0]||(i[0]=H=>s.time_dimension=H),placeholder:"时间粒度",onChange:C},{default:a(()=>[(v(),w(N,null,$(["min","hour","day"],(H,oe)=>e(_,{key:oe,label:H,value:H},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),e(R)]),_:1}),e(x,{label:"时间范围"},{default:a(()=>[e(O,{modelValue:D.value,"onUpdate:modelValue":i[1]||(i[1]=H=>D.value=H),type:"datetimerange",onChange:c,shortcuts:B(P),"value-format":"YYYY-MM-DD HH:mm","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue","shortcuts"]),e(R)]),_:1})]),_:1}),e(T,{onClick:j,style:{cursor:"pointer"}},{default:a(()=>[e(B(Q))]),_:1})])])]),default:a(()=>[X((v(),w("div",pe,[e(te,{gutter:8},{default:a(()=>[e(k,{span:15},{default:a(()=>[e(l,{shadow:"never"},{default:a(()=>[d("div",{ref_key:"ref_chart_container",ref:p,style:{height:"400px"}},null,512)]),_:1})]),_:1}),e(k,{span:9},{default:a(()=>[e(l,{shadow:"never"},{default:a(()=>[d("div",{ref_key:"ref_chart_pie_container",ref:Y,style:{height:"400px"}},null,512)]),_:1})]),_:1})]),_:1})])),[[ae,f.value]])]),_:1})}}},fe=q(he,[["__scopeId","data-v-d90d328f"]]),ge={style:{"margin-top":"30px"}},U="请求方式概览",xe={__name:"index",setup(S){const p=le(),Y=[{path:"/",name:"首页"},{path:"",name:U}];return I(()=>{p.SetTitle(U),p.SetBreadcrumb(Y)}),(h,f)=>(v(),w(N,null,[d("div",null,[e(_e,{chartName:U})]),d("div",ge,[e(fe,{style:{"margin-top":"30px"},chartName:"请求方式调用次数(取决于已经存在的记录)"})])],64))}};export{xe as default};
