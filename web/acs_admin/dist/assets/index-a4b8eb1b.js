import{i as I,r as le,T,a as ne}from"./index-008284a0.js";import{_ as F,r as d,d as N,a as W,o as U,E as z,b as n,c as J,e as p,f as P,w as t,g as _,t as K,h as e,i as O,j as $,F as B,u as R,k as Q,l as X,m as re,n as se}from"./index-07fbba9f.js";import{V as Z,T as ee}from"./time_utils-1ad82d01.js";import{r as ie}from"./index-89cf8bcc.js";import"./request-675639ab.js";const de={class:"card-header"},ce={class:"right_content"},ue={class:"chart"},_e={__name:"groupChart",props:{chartName:{type:String,default:"chart"},groupList:{type:Array,default:[]}},setup(S){const h=d(null),c=S,f=d(!1),g=d(null),u={tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value"},series:[]},C=ee();let v=N(),V=N();V=V.subtract(15,"minute");const D=d([V.format("YYYY-MM-DD HH:mm:ss"),v.format("YYYY-MM-DD HH:mm:ss")]),a=W({time_dimension:"min",begin_time:D.value[0],end_time:D.value[1],group_id:"0"});U(()=>{g.value=I(h.value),c.groupList.length>0&&(a.group_id=c.groupList[0].id),o()});const H=s=>{a.time_dimension=s,o()},k=s=>{a.group_id=s,o()},o=async()=>{let s=Z(a.time_dimension,a.begin_time,a.end_time);if(s!==""){z.error(s);return}f.value=!0;let m=await le(a.time_dimension,a.begin_time,a.end_time,parseInt(a.group_id));f.value=!1;let x=m.data,l="";c.groupList.forEach(i=>{i.id==a.group_id&&(l=i.name)}),u.xAxis.data=x.x_data,u.series=[{name:l,type:"line",data:x.y_data_all_count,areaStyle:{}}],u&&g.value.setOption(u),g.value.setOption(u)},j=()=>{o()},A=s=>{if(s[0]===""||s[1]===0)return!1;a.begin_time=s[0],a.end_time=s[1],o()};return(s,m)=>{const x=n("el-option"),l=n("el-select"),i=n("el-form-item"),y=n("el-date-picker"),M=n("el-form"),Y=n("el-icon"),b=n("el-card"),w=J("loading");return p(),P(b,{class:"box-card",shadow:"never"},{header:t(()=>[_("div",de,[_("span",null,K(c.chartName),1),_("div",ce,[e(M,{inline:!0},{default:t(()=>[e(i,{label:"分组筛选"},{default:t(()=>[e(l,{filterable:"",modelValue:a.group_id,"onUpdate:modelValue":m[0]||(m[0]=r=>a.group_id=r),placeholder:"分组筛选",onChange:k},{default:t(()=>[(p(!0),O(B,null,$(c.groupList,(r,L)=>(p(),P(x,{key:L,label:r.name,value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e(T)]),_:1}),e(i,{label:"时间粒度"},{default:t(()=>[e(l,{modelValue:a.time_dimension,"onUpdate:modelValue":m[1]||(m[1]=r=>a.time_dimension=r),placeholder:"时间粒度",onChange:H},{default:t(()=>[(p(),O(B,null,$(["min","hour","day"],(r,L)=>e(x,{key:L,label:r,value:r},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),e(T)]),_:1}),e(i,{label:"时间范围"},{default:t(()=>[e(y,{modelValue:D.value,"onUpdate:modelValue":m[2]||(m[2]=r=>D.value=r),type:"datetimerange",onChange:A,shortcuts:R(C),"value-format":"YYYY-MM-DD HH:mm","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue","shortcuts"])]),_:1})]),_:1}),e(Y,{onClick:j,style:{cursor:"pointer"}},{default:t(()=>[e(R(Q))]),_:1})])])]),default:t(()=>[X((p(),O("div",ue,[_("div",{ref_key:"ref_chart_container",ref:h,style:{height:"400px"}},null,512)])),[[w,f.value]])]),_:1})}}},me=F(_e,[["__scopeId","data-v-9c2d1baf"]]);const pe={class:"card-header"},he={class:"right_content"},fe={class:"chart"},ge={__name:"allGroupChart",props:{chartName:{type:String,default:"chart"},groupList:{type:Array,default:[]}},setup(S){const h=S,c=d(null),f=d(null),g=d(!1),u=d(null),C=d(null),v={tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value"},series:[]},V={tooltip:{trigger:"item"},legend:{top:"5%",left:"center"},series:[{name:"分组调用占比",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},labelLine:{show:!1},data:[]}]},D=ee();let a=N(),H=N();H=H.subtract(15,"minute");const k=d([H.format("YYYY-MM-DD HH:mm:ss"),a.format("YYYY-MM-DD HH:mm:ss")]),o=W({time_dimension:"min",begin_time:k.value[0],end_time:k.value[1]});U(()=>{u.value=I(c.value),C.value=I(f.value),h.groupList.length>0&&(o.group_id=h.groupList[0].id),A()});const j=l=>{o.time_dimension=l,A()},A=async()=>{let l=Z(o.time_dimension,o.begin_time,o.end_time);if(l!==""){z.error(l);return}g.value=!0;let i=await ne(o.time_dimension,o.begin_time,o.end_time);g.value=!1;let y=i.data;v.xAxis.data=y.x_data;let M=[];const Y=[];Object.keys(y.y_data).forEach(b=>{M.push({name:b,type:"line",data:y.y_data[b]});let w=0;y.y_data[b].forEach(r=>{w+=r}),Y.push({value:w,name:b})}),v.series=M,v&&u.value.setOption(v),u.value.setOption(v),s(Y)},s=l=>{V.series[0].data=l,C.value.setOption(V)},m=()=>{A()},x=l=>{if(l[0]===""||l[1]===0)return!1;o.begin_time=l[0],o.end_time=l[1],A()};return(l,i)=>{const y=n("el-option"),M=n("el-select"),Y=n("el-form-item"),b=n("el-date-picker"),w=n("el-form"),r=n("el-icon"),L=n("el-card"),q=n("el-col"),te=n("el-row"),ae=J("loading");return p(),P(L,{class:"box-card",shadow:"never"},{header:t(()=>[_("div",pe,[_("span",null,K(h.chartName),1),_("div",he,[e(w,{inline:!0},{default:t(()=>[e(Y,{label:"时间粒度"},{default:t(()=>[e(M,{modelValue:o.time_dimension,"onUpdate:modelValue":i[0]||(i[0]=G=>o.time_dimension=G),placeholder:"时间粒度",onChange:j},{default:t(()=>[(p(),O(B,null,$(["min","hour","day"],(G,oe)=>e(y,{key:oe,label:G,value:G},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),e(T)]),_:1}),e(Y,{label:"时间范围"},{default:t(()=>[e(b,{modelValue:k.value,"onUpdate:modelValue":i[1]||(i[1]=G=>k.value=G),type:"datetimerange",onChange:x,shortcuts:R(D),"value-format":"YYYY-MM-DD HH:mm","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue","shortcuts"]),e(T)]),_:1})]),_:1}),e(r,{onClick:m,style:{cursor:"pointer"}},{default:t(()=>[e(R(Q))]),_:1})])])]),default:t(()=>[X((p(),O("div",fe,[e(te,{gutter:8},{default:t(()=>[e(q,{span:15},{default:t(()=>[e(L,{shadow:"never"},{default:t(()=>[_("div",{ref_key:"ref_chart_container",ref:c,style:{height:"400px"}},null,512)]),_:1})]),_:1}),e(q,{span:9},{default:t(()=>[e(L,{shadow:"never"},{default:t(()=>[_("div",{ref_key:"ref_chart_pie_container",ref:f,style:{height:"400px"}},null,512)]),_:1})]),_:1})]),_:1})])),[[ae,g.value]])]),_:1})}}},ve=F(ge,[["__scopeId","data-v-dd28b69d"]]),ye={style:{"margin-top":"30px"}},E="分组调用次数",Ve={__name:"index",setup(S){const h=d([]),c=d(!1),f=re(),g=[{path:"/",name:"首页"},{path:"",name:E}];U(()=>{f.SetTitle(E),f.SetBreadcrumb(g),u()});const u=()=>{ie().then(C=>{h.value=C.data,c.value=!0})};return(C,v)=>(p(),O(B,null,[_("div",null,[c.value?(p(),P(me,{key:0,groupList:h.value,chartName:E},null,8,["groupList"])):se("",!0)]),_("div",ye,[e(ve,{style:{"margin-top":"30px"},chartName:"按分组调用次数"})])],64))}};export{Ve as default};
