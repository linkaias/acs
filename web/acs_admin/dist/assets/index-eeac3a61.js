import{c as R,i as q,T as S}from"./index-008284a0.js";import{_ as F,r as _,d as Y,a as I,o as H,E as U,b as n,c as j,e as h,f as C,w as o,g as i,t as z,h as e,i as M,F as G,j as J,u as T,k as K,l as k,m as Q}from"./index-07fbba9f.js";import{u as W}from"./index-1cdbe6fb.js";import{V as X,T as Z}from"./time_utils-1ad82d01.js";import{r as ee}from"./index-89cf8bcc.js";import{r as te}from"./index-77a01a79.js";import"./request-675639ab.js";const ae={chartApi:R,userApi:W};const oe={class:"card-header"},le={class:"right_content"},ne={class:"chart"},se={__name:"AllCountChart",props:{chartName:{type:String,default:"chart"}},setup(w){const c=_(null),f=w,d=_(!1),u=_(null),m={tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{data:["总调用次数"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value"},series:[]},D=Z();let v=Y(),l=Y();l=l.subtract(15,"minute");const t=_([l.format("YYYY-MM-DD HH:mm:ss"),v.format("YYYY-MM-DD HH:mm:ss")]),a=I({time_dimension:"min",begin_time:t.value[0],end_time:t.value[1]});H(()=>{u.value=q(c.value),s()});const p=r=>{a.time_dimension=r,s()},s=async()=>{let r=X(a.time_dimension,a.begin_time,a.end_time);if(r!==""){U.error(r);return}d.value=!0;let g=await ae.chartApi.reqGetAllCount(a.time_dimension,a.begin_time,a.end_time);d.value=!1;let x=g.data;m.xAxis.data=x.x_data,m.series=[{name:"总调用次数",type:"line",data:x.y_data_all_count,areaStyle:{}}],m&&u.value.setOption(m),u.value.setOption(m)},A=()=>{s()},y=r=>{if(r[0]===""||r[1]===0)return!1;a.begin_time=r[0],a.end_time=r[1],s()};return(r,g)=>{const x=n("el-option"),O=n("el-select"),V=n("el-form-item"),B=n("el-date-picker"),E=n("el-form"),N=n("el-icon"),P=n("el-card"),$=j("loading");return h(),C(P,{class:"box-card",shadow:"never"},{header:o(()=>[i("div",oe,[i("span",null,z(f.chartName),1),i("div",le,[e(E,{inline:!0},{default:o(()=>[e(V,{label:"时间粒度"},{default:o(()=>[e(O,{modelValue:a.time_dimension,"onUpdate:modelValue":g[0]||(g[0]=b=>a.time_dimension=b),placeholder:"时间粒度",onChange:p},{default:o(()=>[(h(),M(G,null,J(["min","hour","day"],(b,L)=>e(x,{key:L,label:b,value:b},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),e(S)]),_:1}),e(V,{label:"时间范围"},{default:o(()=>[e(B,{modelValue:t.value,"onUpdate:modelValue":g[1]||(g[1]=b=>t.value=b),type:"datetimerange",onChange:y,shortcuts:T(D),"value-format":"YYYY-MM-DD HH:mm","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue","shortcuts"]),e(S)]),_:1})]),_:1}),e(N,{onClick:A,style:{cursor:"pointer"}},{default:o(()=>[e(T(K))]),_:1})])])]),default:o(()=>[k((h(),M("div",ne,[i("div",{ref_key:"ref_chart_container",ref:c,style:{height:"400px"}},null,512)])),[[$,d.value]])]),_:1})}}},re=F(se,[["__scopeId","data-v-270562c7"]]),ie=i("div",{class:"card-header"},[i("span",null,"请求分组信息")],-1),ce=i("div",{class:"card-header"},[i("span",null,"系统参数")],-1),de={__name:"infoTable",setup(w){const c=_(!1),f=_([]),d=_(!1),u=_([]);H(()=>{m(),D()});const m=async()=>{c.value=!0;let v=await ee();c.value=!1;let l=v.data;for(let t=0;t<l.length;t++)l[t].created_at=Y(l[t].created_at).format("YYYY-MM-DD HH:mm:ss"),l[t].updated_at=Y(l[t].updated_at).format("YYYY-MM-DD HH:mm:ss");f.value=l},D=async()=>{d.value=!0;let v=await te();d.value=!1;let l=v.data,t=[];Object.keys(l).forEach(a=>{let p=l[a];Object.keys(p).forEach(s=>{t.push({name:s,value:p[s]})})}),u.value=t};return(v,l)=>{const t=n("el-table-column"),a=n("el-table"),p=n("el-card"),s=n("el-col"),A=n("el-row"),y=j("loading");return h(),C(A,{gutter:20},{default:o(()=>[e(s,{span:12},{default:o(()=>[e(p,{shadow:"never"},{header:o(()=>[ie]),default:o(()=>[k((h(),C(a,{data:f.value,style:{width:"100%",height:"300px"}},{default:o(()=>[e(t,{prop:"id",label:"ID",width:"80"}),e(t,{prop:"name",label:"分组名称",width:"180"}),e(t,{prop:"desc",label:"分组描述"}),e(t,{prop:"updated_at",label:"更新时间",width:"180"}),e(t,{prop:"created_at",label:"创建时间",width:"180"})]),_:1},8,["data"])),[[y,c.value]])]),_:1})]),_:1}),e(s,{span:12},{default:o(()=>[e(p,{shadow:"never"},{header:o(()=>[ce]),default:o(()=>[k((h(),C(a,{data:u.value,style:{width:"100%",height:"300px"}},{default:o(()=>[e(t,{type:"index",label:"序号",width:"100"}),e(t,{prop:"name",label:"参数名称",width:"280"}),e(t,{prop:"value",label:"参数值"})]),_:1},8,["data"])),[[y,d.value]])]),_:1})]),_:1})]),_:1})}}},_e={style:{"margin-top":"30px"}},be={__name:"index",setup(w){const c=I(Q()),f=[{path:"/",name:"首页"},{path:"",name:"总调用次数概览"}];return H(()=>{c.SetTitle("总调用次数概览"),c.SetBreadcrumb(f)}),(d,u)=>(h(),M(G,null,[i("div",null,[e(re,{chartName:"总调用次数"})]),i("div",_e,[e(de)])],64))}};export{be as default};
